---
title: "STAT40620 - Assignment 1"
author: "Ross Jackson, 19343511"
date: "10/11/2021"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## Manipulation 

1. Load the dataset
```{r}
eurstat <- read.csv('/Users/rossjackson/Documents/myfolder/EurostatCrime2019.csv')
eurstat
attach(eurstat)
```
2. What is the size and the structure of the dataset?
```{r}
dim(eurstat)
str(eurstat)
```
3. Produce appropriate commands to do the following:
(i) Remove the columns Rape and Sexual.assault 
```{r}
eurstat$Rape <- NULL
eurstat$Sexual.assault <- NULL
head(eurstat)
```
(ii) Remove the columnns Theft, Theft.of.a.motorized.land.vehicle, Burglary, Burglary.of.private.residential.premises
```{r}
eurstat$Theft <- NULL
eurstat$Theft.of.a.motorized.land.vehicle <- NULL
eurstat$Burglary <- NULL
eurstat$Burglary.of.private.residential.premises <- NULL
```
(iii) Add a column containing the overall record of offences for each country
```{r}
eurstat$total_offences <- eurstat[,2] + eurstat[,3] + eurstat[,4] + eurstat[,5] + eurstat[,6] + eurstat[,7] + eurstat[,8]
eurstat$total_offences
```
4. Work with the dataset you just created, and list the countries that contain any missing data
```{r}
missing_values <- eurstat[rowSums(is.na(eurstat))>0,]
missing_values$X
```
5. Remove the countries with missing data from the data frame
```{r}
eurstat2 <- eurstat[complete.cases(eurstat), ]
eurstat2$X
```
6. How many observations and variables are in this new dataframe
```{r}
dim(eurstat2)
```

## Task 2 : Analysis

1. According to these data what were the 3 most common crimes in Ireland in 2019
```{r}
ire_crime <- eurstat2[10, ]
ire_crime2 <- ire_crime[, 2:8]
rev(sort(ire_crime2))
```
2. What proportion of the overall crimes was due to Assault in Ireland in 2019?
```{r}
Ire_assault <- eurstat2[10,4]
ire_total <- eurstat2[10,9]
Ire_assault_prop <- Ire_assault / ire_total
Ire_assault_prop
```
3. Which country had the highest record of kidnapping in 2019
```{r}
highest_kidnapp <- eurstat2[rev(order(eurstat2$Kidnapping)), ]
highest_kidnapp[1,1]
```
4. Which country had the lowest overall record offences in 2019 ? 
```{r}
lowest_record <- eurstat2[order(eurstat2$total_offences), ]
lowest_record[1,1]
```
5. Create a plot displaying the relationship between robbery and unlawful acts involving controlled drugs or precursors. Make the plot look "nice"
```{r}
plot(eurstat2$Robbery, eurstat2$Unlawful.acts.involving.controlled.drugs.or.precursors, main = 'Relationship between Robbery and Unlawful acts involving controlled drugs or precursors' , xlab = "Robbery",
     ylab = "Unlawful acts involving controlled drugs or precursors", col = rep(2), pch = 20)
abline(lm(eurstat2$Unlawful.acts.involving.controlled.drugs.or.precursors ~ eurstat2$Robbery, data = eurstat2), col = 'blue')
```
### Task 3 : Creativity
Do something interesting with the data (either the original or the modified). Create a nice plot which shows something we have not discovered above already and outline your findings.

```{r}
# Graphing the two variables Unlawful acts involving controlled drugs or precursors and for Sexual Violence to observe whether or not there may be a relationship between the two. 
plot(eurstat2$Sexual.violence, eurstat2$Unlawful.acts.involving.controlled.drugs.or.precursors, main = "Relationship between Sexual Violence and Unlawful acts involving controlled drugs or precursors", xlab = "Sexual Violence", ylab = "Unlawful acts involving controlled drugs or precursors", col = rep(4), pch = 18)
abline(lm(eurstat2$Unlawful.acts.involving.controlled.drugs.or.precursors ~ eurstat2$Sexual.violence, data = eurstat2), col = 'green')

coef(lm(eurstat2$Unlawful.acts.involving.controlled.drugs.or.precursors ~ eurstat2$Sexual.violence))
```
From the graph above, we can observe that there is some positive relationship between Sexual Violence and Unlawful acts involving controlled drugs or precursors. Although this relationship is not very strong, there is reason to believe that in countries where there are higher rates of unlawful acts involving drugs, you may also expect to find a higher number of cases involving Sexual Violence.
